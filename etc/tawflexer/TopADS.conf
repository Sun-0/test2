name="TopADS";
type="TopADS";
expressions=(
	{
		field="ORIGINAL_DATA";
		separator="WELF()";
		tokenmaps=(
			{
				condition = "e.type == 'mgmt'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="s_user"; value="user"; },
					{name="s_sub_type"; value="s_type"; },
					{name="s_op"; value="op"; },
					{name="s_method"; value="method"; },
					{name="s_result"; value="result"; },
					{name="s_message"; value="msg"; }
				);
			},
			{
				condition = "e.sub_type == 'attacklog'";
				maps=(					
						{name="s_sub_type"; value="sub_type"; },	
						{name="s_type"; value="type";},						
						{name="i_dst_addr"; value="_FormatIP(dst_addr)"; },
						{name="s_grpname"; value="grpname"; },
						{name="s_attack_type"; value="attack_type"; remove=0},
						{name="EVENT_TYPE"; value="attack_type"; },
						{name="s_attack_status"; value="attack_status"; },
						{name="s_src_addr"; value="_FormatReplace(src_addr)"; remove=0},
						{name="s_src_addr"; value="src_addr";},
						{name="s_service"; value="service";},
						{name="s_protocol_4"; value="protocol_4";},
						{name="i_dst_port"; value="_FormatUint16(dst_port)";},
						{name="s_defense_method"; value="defense_method";},
						{name="i_cur_cfg_value"; value="_FormatUint64(cur_cfg_value)";},
						{name="s_cfg_value_unit"; value="cfg_value_unit";},				
						{name="i_total_packets"; value="_FormatUint64(total_packets)";},
						{name="i_total_bytes"; value="_FormatUint64(total_bytes)";},
						{name="i_attack_packets"; value="_FormatUint64(attack_packets)";},
						{name="i_attack_bytes"; value="_FormatUint64(attack_bytes)";},
						{name="s_action"; value="action";},
						{name="s_attack_msgs"; value="attack_msgs";},
						{name="s_backup1"; value="backup1";},
						{name="s_backup2"; value="backup2";},
						{name="s_backup3"; value="backup3";}
					);
			},
			{
				condition = "e.sub_type == 'flowlog'";
				maps=(
						{name="s_sub_type"; value="sub_type"},
						{name="s_type"; value="type";},
						{name="i_time_interval"; value="_FormatUint16(time_interval)";},
						{name="i_dst_addr"; value="_FormatIP(dst_addr)";},
						{name="s_grpname"; value="grpname";},
						{name="i_ip_flow_p"; value="_FormatUint64(ip_flow_p)"; },
						{name="i_cut_ip_flow_p"; value="_FormatUint64(cut_ip_flow_p)";},
						{name="i_ipfrag_flow_p"; value="_FormatUint64(ipfrag_flow_p)";},
						{name="i_cut_ipfrag_flow_p"; value="_FormatUint64(cut_ipfrag_flow_p)";},
						{name="i_tcp_flow_p"; value="_FormatUint64(tcp_flow_p)";},
						{name="i_cut_tcp_flow_p"; value="_FormatUint64(cut_tcp_flow_p)";},
						{name="i_udp_flow_p"; value="_FormatUint64(udp_flow_p)";},
						{name="i_cut_udp_flow_p"; value="_FormatUint64(cut_udp_flow_p)";},
						{name="i_icmp_flow_p"; value="_FormatUint64(icmp_flow_p)";},
						{name="i_cut_icmp_flow_p"; value="_FormatUint64(cut_icmp_flow_p)";},
						{name="i_dns_flow_p"; value="_FormatUint64(dns_flow_p)";},
						{name="i_cut_dns_flow_p"; value="_FormatUint64(cut_dns_flow_p)";},
						{name="i_http_flow_p"; value="_FormatUint64(http_flow_p)";},
						{name="i_cut_http_flow_p"; value="_FormatUint64(cut_http_flow_p)";},
						{name="i_https_flow_p"; value="_FormatUint64(https_flow_p)";},
						{name="i_cut_https_flow_p"; value="_FormatUint64(cut_https_flow_p)";},
						{name="i_sip_flow_p"; value="_FormatUint64(sip_flow_p)";},
						{name="i_cut_sip_flow_p"; value="_FormatUint64(cut_sip_flow_p)";},
						{name="i_ip_flow_b"; value="_FormatUint64(ip_flow_b)"; },	
						{name="i_cut_ip_flow_b"; value="_FormatUint64(cut_ip_flow_b)";},
						{name="i_ipfrag_flow_b"; value="_FormatUint64(ipfrag_flow_b)";},
						{name="i_cut_ipfrag_flow_b"; value="_FormatUint64(cut_ipfrag_flow_b)";},
						{name="i_tcp_flow_b"; value="_FormatUint64(tcp_flow_b)";},
						{name="i_cut_tcp_flow_b"; value="_FormatUint64(cut_tcp_flow_b)";},
						{name="i_udp_flow_b"; value="_FormatUint64(udp_flow_b)";},
						{name="i_cut_udp_flow_b"; value="_FormatUint64(cut_udp_flow_b)";},
						{name="i_icmp_flow_b"; value="_FormatUint64(icmp_flow_b)";},
						{name="i_cut_icmp_flow_b"; value="_FormatUint64(cut_icmp_flow_b)";},
						{name="i_dns_flow_b"; value="_FormatUint64(dns_flow_b)";},
						{name="i_cut_dns_flow_b"; value="_FormatUint64(cut_dns_flow_b)";},
						{name="i_http_flow_b"; value="_FormatUint64(http_flow_b)";},
						{name="i_cut_http_flow_b"; value="_FormatUint64(cut_http_flow_b)";},
						{name="i_cut_https_flow_b"; value="_FormatUint64(cut_https_flow_b)";},
						{name="i_sip_flow_b"; value="_FormatUint64(sip_flow_b)";},
						{name="i_https_flow_b"; value="_FormatUint64(https_flow_b)";},
						{name="i_cut_sip_flow_b"; value="_FormatUint64(cut_sip_flow_b)";},
						{name="s_backup1"; value="backup1";},
						{name="s_backup2"; value="backup2";},
						{name="s_backup3"; value="backup3";},
						{name="s_backup4"; value="backup4";}					
					);
			},
			{
				condition = "e.sub_type == 'leadlog'";
				maps=(
						{name="s_sub_type"; value="sub_type"},
						{name="s_type"; value="type";},
						{name="i_dst_addr"; value="_FormatIP(dst_addr)";},
						{name="s_dst_mask"; value="dst_mask";},
						{name="i_sendto"; value="_FormatIP(sendto)";},
						{name="s_grpname"; value="grpname";},
						{name="s_lead_action"; value="lead_action";},
						{name="s_lead_way"; value="lead_way";},
						{name="i_lead_src_addr"; value="_FormatIP(lead_src_addr)";},
						{name="s_admin"; value="admin";},
						{name="s_lead_msgs"; value="lead_msgs";}					
					);
			},
			{
				condition = "e.sub_type == 'capturelog'";
				maps=(
						{name="s_sub_type"; value="sub_type"},
						{name="s_type"; value="type";},
						{name="s_file_name"; value="file_name";},
						{name="s_cap_status"; value="cap_status";},
						{name="s_cap_type"; value="cap_type";},
						{name="s_sample_ratio"; value="_FormatUint8(sample_ratio)";},
						{name="s_max_value"; value="_FormatInt32(max_value)";},
						{name="s_backup1"; value="backup1";},
						{name="s_backup2"; value="backup2";},
						{name="s_backup3"; value="backup3";}
					);
			},
			{
				condition = "e.type == 'linkage_log'";
				maps = (
					{name="s_sub_type"; value="type"},
					{name="s_la_sub_type"; value="sub_type"},
				    { name="s_Anmoaly"; value="Anmoaly"; },
					{ name="i_ID"; value="_FormatUint32(ID)"; },
					{ name="s_Status"; value="Status"; },
					{ name="s_la_sub_type"; value="la_sub_type"; },
					{ name="i_device_key"; value="_FormatUint64(device_key)";},
					{ name="i_start"; value="_FormatTime0(start)";},
					{ name="i_update"; value="_FormatTime0(update)";},
					{ name="i_dst"; value="_FormatIP(dst)"; },
					{ name="i_dport"; value="_FormatUint16(dport)"; },
					{ name="s_zone_name"; value="zone_name"; },
					{ name="s_classification"; value="classification"; }
				);
			}
		);
		maps=(
				{name="i_client_addr"; value="_FormatIP(client_addr)";},
				{name="s_id"; value="id";},
				{name="s_version"; value="version";},
				{name="i_time"; value="_FormatTime0(time)";},
				{name="s_dev"; value="dev";},
				{name="s_pri"; value="pri";},
				{name="s_recorder"; value="recorder";},
				{name="i_vsid"; value="_FormatUint64(vsid)";},		
				{name="s_zonename"; value="zonename";}
			);
	}
);


