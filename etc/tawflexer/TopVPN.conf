name="TopVPN";
type="TopVPN";
expressions=(
	{
		field="ORIGINAL_DATA";
		separator="WELF()";
		tokenmaps=(
			{
				condition = "e.type == 'sv_system'";
				maps = (	
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_op"; value="op";},
					{name="s_user"; value="user";},
					{name="s_session_id"; value="session_id";},
					{name="s_userid"; value="userid";},
					{name="s_status"; value="status";},
					{name="s_dst"; value="dst";},
					{name="i_src"; value="_FormatIP(ip)";},
					{name="i_duration"; value="_FormatUint64(duration)";}
				);
			},
			{
				condition = "e.type == 'sv_wf' or e.type == 'sv_pf'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_op"; value="op";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="s_user"; value="user";},
					{name="s_url"; value="url";},
					{name="s_result"; value="result";},
					{name="s_referrer"; value="referrer";},
					{name="s_userid"; value="userid";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="i_rcvd"; value="_FormatUint64(rcvd)";},
					{name="i_sent"; value="_FormatUint64(sent)";}
				);
			},
			{
				condition = "e.type == 'sv_cifs'"
				tokenmaps = (
					{
						condition = "e.op == flow_count";
						maps = (
							{name="s_op"; value="op";},
							{name="i_src"; value="_FormatIP(src)";},
							{name="i_dst"; value="_FormatIP(dst)";}
						);
					}
				);
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_top2"; value="src";},
					{name="s_top3"; value="dst";},
					{name="s_id"; value="id";},
					{name="s_user"; value="user";},
					{name="s_smbuname"; value="smbuname";},
					{name="s_base"; value="base";},
					{name="i_rcvd"; value="_FormatUint64(rcvd)";},
					{name="i_sent"; value="_FormatUint64(sent)";},
					{name="s_result"; value="result";},
					{name="s_userid"; value="userid";}
				);
			},
			{
				condition = "e.type == 'sv_netacc'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_op"; value="op";},
					{name="s_user"; value="user";},
					{name="s_alg_tag"; value="alg_tag";},
					{name="s_result"; value="result";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_rcvd"; value="_FormatUint64(rcvd)";},
					{name="i_sent"; value="_FormatUint64(sent)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_userid"; value="userid";}
				);
			},
			{
				condition = "e.type == 'vpn'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_recorder"; value="recorder";}
				);
			},
			{
				condition = "e.type == 'user_auth' or e.type == 'mgmt' or e.type == 'system'";
				maps = (
					{name="s_sub_type"; value="type";},				
					{name="s_id"; value="id";},
					{name="s_op"; value="op";},
					{name="s_user"; value="user";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="s_result"; value="result";},
					{name="s_recorder"; value="recorder";}
				);
			},
			{
				condition = "e.type == 'system' and e.user != NULL";
				maps = (
					{name="s_sub_type"; value="type";},				
					{name="s_id"; value="id";},
					{name="s_op"; value="op";},
					{name="s_user"; value="user";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="s_result"; value="result";},
					{name="s_recorder"; value="recorder";}
				);
			},
			{
				condition = "e.type == 'conn'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_recorder"; value="recorder";},
					{name="s_proto"; value="proto";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_trans_src"; value="_FormatIP(trans_src)";},
					{name="i_trans_dst"; value="_FormatIP(trans_dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="i_trans_sport"; value="_FormatUint16(trans_sport)";},
					{name="i_trans_dport"; value="_FormatUint16(trans_dport)";},
					{name="i_inpkt"; value="_FormatUint64(inpkt)";},
					{name="i_outpkt"; value="_FormatUint64(outpkt)";},
					{name="i_rcvd"; value="_FormatUint64(rcvd)";},
					{name="i_sent"; value="_FormatUint64(sent)";},
					{name="i_duration"; value="_FormatUint64(duration)";},
					{name="i_connid"; value="_FormatUint64(connid)";},
					{name="i_parent"; value="_FormatUint64(parent)";},
					{name="s_op"; value="op";}
				);
			},
			{
				condition = "e.type == 'ac'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_recorder"; value="recorder";},
					{name="s_rule"; value="rule";},
					{name="s_proto"; value="proto";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_smac"; value="smac";},
					{name="s_dmac"; value="dmac";},
					{name="s_user"; value="user";},
					{name="s_indev"; value="indev";},
					{name="s_outdev"; value="outdev";},
					{name="i_connid"; value="_FormatUint64(connid)";},
					{name="i_parentid"; value="_FormatUint64(parentid)";},
					{name="s_policyid"; value="policyid";},	
					{name="s_dpiid"; value="dpiid";},
					{name="i_natid"; value="_FormatUint64(natid)";}
				);
			},
			{
				condition = "e.type == 'pf'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_rule"; value="rule";},
					{name="s_proto"; value="proto";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_smac"; value="smac";},
					{name="s_dmac"; value="dmac";},
					{name="s_indev"; value="indev";},
					{name="s_policyid"; value="policyid";}
				);
			},
			{
				condition = "e.type == 'secure'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_recorder"; value="recorder";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";}
				);
			},
			{
				condition = "e.type == 'dpi'";
				tokenmaps = (
					{
						condition = "e.proto == 'TCP' or e.proto == 'UDP'";
						maps = (
							{name="s_proto"; value="proto";},
							{name="s_recorder"; value="recorder";},
							{name="s_user"; value="user";},
							{name="s_op"; value="op";},
							{name="i_src"; value="_FormatIP(src)";},
							{name="i_dst"; value="_FormatIP(dst)";},
							{name="s_dstname"; value="dstname";},
							{name="s_arg"; value="arg";},
							{name="i_connid"; value="_FormatUint64(connid)";},
							{name="s_policyid"; value="policyid";}
						);
					},
					{
						condition = "e.proto != 'TCP' and e.proto != 'UDP'";
						tokenmaps = (
							{
								condition = "e.proto == 'http'";
								maps = (
									{name="s_proto"; value="proto";},
									{name="s_method"; value="method";},
									{name="s_url"; value="url";},
									{name="s_title"; value="title";},
									{name="s_urltype"; value="urltype";},
									{name="s_filetype"; value="filetype";}
								);
							},
							{
								condition = "e.proto == 'ftp'";
								maps = (
									{name="s_proto"; value="proto";},
									{name="s_filename"; value="filename";},
									{name="s_command"; value="command";},
									{name="s_filetype"; value="filetype";}			
								);
							},
							{
								condition = "e.proto == 'dns'";
								maps = (
									{name="s_proto"; value="proto";},
									{name="s_domain"; value="domain";}
								);
							},
							{
								condition = "e.proto == 'rsh' or e.proto == 'telnet'";
								maps = (
									{name="s_proto"; value="proto";},
									{name="s_command"; value="command";}
								);
							},
							{
								condition = "e.proto == 'smtp' or e.proto == 'pop3' or e.proto == 'imap'";
								maps = (
									{name="s_proto"; value="proto";},
									{name="s_sender"; value="sender";},
									{name="s_receiver"; value="receiver";},
									{name="s_cc"; value="cc";},
									{name="s_subject"; value="subject";},
									{name="s_filename"; value="filename";},
									{name="s_filetype"; value="filetype";}
								);
							}
						);
						maps = (							
							{name="s_filter"; value="filter";},
							{name="s_rule"; value="action";},
							{name="s_policyid"; value="policyid";},							
							{name="s_user"; value="user";},
							{name="i_src"; value="_FormatIP(src)";},
							{name="i_dst"; value="_FormatIP(dst)";},
							{name="i_sport"; value="_FormatUint16(sport)";},
							{name="i_dport"; value="_FormatUint16(dport)";}
						);
					}
					
				);
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";}
					
				);
			},
			{
				condition = "e.type == 'avse'";
				tokenmaps = (
					{
						condition = "e.subtype == ''";	//值为空
						tokenmaps = (
							{
								condition = "e.proto != ''";
								tokenmaps = (
									{
										condition = "e.proto == 'http'";
										maps = (
											{name="s_proto"; value="proto";},
											{name="s_method"; value="method";},
											{name="s_url"; value="url";},
											{name="s_title"; value="title";}
										);
									},
									{
										condition = "e.proto == 'ftp'";
										maps = (
											{name="s_proto"; value="proto";},
											{name="s_filename"; value="filename";},
											{name="s_command"; value="command";}
										);
									},
									{
										condition = "e.proto == 'smtp' or e.s_proto == 'pop3' or e.s_proto == 'imap'";
										maps = (
											{name="s_proto"; value="proto";},
											{name="s_sender"; value="sender";},
											{name="s_receiver"; value="receiver";},
											{name="s_cc"; value="cc";},
											{name="s_subject"; value="subject";},
											{name="s_filename"; value="filename";}
										);
									}
								);
								maps = (																		
									{name="s_user"; value="user";},
									{name="i_src"; value="_FormatIP(src)";},
									{name="i_src"; value="_FormatIP(dst)";},
									{name="i_sport"; value="_FormatUint16(sport)";},
									{name="i_dport"; value="_FormatUint16(dport)";},
									{name="s_virus_name"; value="virus_name";},
									{name="s_virus_deal"; value="virus_deal";},
									{name="s_filter"; value="filter";},
									{name="s_rule"; value="action";},
									{name="s_policyid"; value="policyid";},
									{name="s_filetype"; value="filetype";}
								);
							}
						);
						maps = (
							{name="s_subtype"; value="subtype";},
							{name="s_virus_name"; value="virus_name";}					
						);
					},
					{
						condition = "e.subtype != ''";
						maps = (
							{name="s_subtype"; value="subtype";},
							{name="s_normal_object"; value="normal_object";},
						    {name="s_virus_object"; value="virus_object";},
							{name="s_proto"; value="proto";},
							{name="s_subtype"; value="subtype";},
							{name="s_virus"; value="virus";},	
							{name="s_op"; value="op";},
							{name="s_fileinfected"; value="fileinfected";},
							{name="i_src"; value="_FormatIP(src)";},
							{name="i_src"; value="_FormatIP(dst)";},
							{name="s_sender"; value="sender";},
							{name="s_receiver"; value="receiver";},
							{name="s_subject"; value="subject";},
							{name="i_size"; value="_FormatUint64(size)";}						
						);
					}
					
				);
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";}
				);

			},
			{
				condition = "e.type == 'asse'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_proto"; value="proto";},
				    {name="s_user"; value="user";},
				    {name="i_src"; value="_FormatIP(src)";},
					{name="i_src"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_sender"; value="sender";},
					{name="s_receiver"; value="receiver";},
					{name="s_subject"; value="subject";},
					{name="s_cc"; value="cc";},
					{name="s_filename"; value="filename";},
					{name="s_domain"; value="domain";},
					{name="s_spam_policy"; value="spam_policy";},
					{name="s_spam_deal"; value="spam_deal";},
					{name="s_id"; value="id";}
				);
			},
			{
				condition = "e.type == 'ar'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_proto"; value="proto";},
					{name="s_user"; value="user";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_src"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_ar_count"; value="ar_count";},
					{name="s_filter"; value="filter";},
					{name="s_rule"; value="action";},
					{name="s_policyid"; value="policyid";},
					{name="s_id"; value="id";}
				);
			},
			{
				condition = "e.type == 'stat'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_recorder"; value="recorder";}	
				);
			},
			{
				condition = "e.type == 'iips' or e.type == 'ar'";
				tokenmaps = (
					{
						condition = "e.recorder == 'IPSEVENT' or e.recorder == 'IPSAR' or e.recorder == 'IPSAV' or e.recorder == 'IPSURL'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="s_proto"; value="proto";},
							{name="i_src"; value="_FormatIP(src)";},
							{name="i_src"; value="_FormatIP(dst)";},
							{name="i_sport"; value="_FormatUint16(sport)";},
							{name="i_dport"; value="_FormatUint16(dport)";},
							{name="i_repeat"; value="_FormatUint32(repeat)";},
							{name="s_appendix"; value="appendix";},
							{name="s_op"; value="op";}
						);
					},
					{
						condition = "e.recorder == 'IPSFLOW_AR' or e.recorder == 'IPSFLOW_IP'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="s_is_group"; value="is_group";},
							{name="i_ip"; value="_FormatIP(ip)";},
							{name="i_rcvd"; value="_FormatUint64(rcvd)";},
							{name="i_sent"; value="_FormatUint64(sent)";},
							{name="i_session"; value="_FormatUint32(session)";},
							{name="s_stat_time"; value="stat_time";}
						);
					},
					{
						condition = "e.recorder == 'IPSPACKET'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="i_packetlen"; value="_FormatUint32(packetlen)";},
							{name="s_packet"; value="packet";}
						);
					},
					{
						condition = "e.recorder == 'IPSFLOW'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="i_inpkt"; value="_FormatUint64(inpkt)";},
							{name="i_outpkt"; value="_FormatUint64(outpkt)";},
							{name="i_rcvd"; value="_FormatUint64(rcvd)";},
							{name="i_sent"; value="_FormatUint64(sent)";},
							{name="s_top1"; value="top1";},
							{name="s_top2"; value="top2";},
							{name="s_top3"; value="top3";}
						);
					}
				);
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_id"; value="id";},
					{name="s_rule"; value="rule";},
					{name="s_application"; value="application";},
					{name="s_interface"; value="interface";},
					{name="s_sdev"; value="sdev";},
					{name="s_ddev"; value="ddev";}
				);
			}												
		);
		maps=(
				{name="i_client_addr";value="_FormatIP(client_addr)";},				
				{name="s_dev"; value="dev";},								
				{name="i_time"; value="_FormatTime(time)";},
				{name="s_fw"; value="fw";},
				{name="s_pri"; value="pri";},
				{name="s_message"; value="msg";}
		);
	}
);
