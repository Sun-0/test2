name="TopIDP";
type="TopIDP";
expressions=(
	{
		field="ORIGINAL_DATA";
		separator="WELF()";
		tokenmaps=(
			{
				condition = "e.type == 'user_auth' or e.type == 'mgmt'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_user"; value="user";},
					{name="s_op"; value="op";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="s_result"; value="result";},
					{name="s_recorder"; value="recorder";},
					{name="s_message"; value="msg";}		
				);
			},
			{
				condition = "e.type == 'system' and e.user == NULL";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_op"; value="op";},
					{name="s_result"; value="result";},
					{name="s_recorder"; value="recorder";},
					{name="s_idp_message"; value="msg";}		
				);
			},
			{
				condition = "e.type == 'ips' or e.type == 'ar'";
				tokenmaps = (
					{
						condition = "e.recorder == 'IPSEVENT' or e.recorder == 'IPSAR' or e.recorder == 'IPSAV' or e.recorder == 'IPSURL'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="s_proto"; value="proto";},
							{name="i_src"; value="_FormatIP(src)";},
							{name="i_dst"; value="_FormatIP(dst)";},
							{name="i_sport"; value="_FormatUint16(sport)";},
							{name="i_dport"; value="_FormatUint16(dport)";},
							{name="i_repeat"; value="_FormatUint32(repeat)";},
							{name="s_message"; value="msg"; remove=0},
							{name="EVENT_TYPE"; value="msg";},
							{name="s_op"; value="op";},
							{name="s_rule"; value="op";},
							{name="s_appendix"; value="appendix";}	
						);
					},
					{
						condition = "e.recorder == 'IPSFLOW_AR' or e.recorder == 'IPSFLOW_IP'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="s_is_group"; value="is_group";},
							{name="i_ip"; value="_FormatIP(ip)";},
							{name="i_sent"; value="_FormatUint64(sent)"; },
							{name="i_rcvd"; value="_FormatUint64(rcvd)"; },
							{name="i_session"; value="_FormatUint32(session)";},
							{name="i_stat_time"; value="_FormatTime(stat_time)";}
						);
					},
					{
						condition = "e.recorder == 'IPSPACKET'";
						maps = (
							{name="s_recorder"; value="recorder";},
							{name="i_packetlen"; value="_FormatUint32(packetlen)";},
							{name="i_packet"; value="_FormatUint32(packet)";}
						);
					},
					{
						condition = "e.recorder == 'IPSFLOW'";
						maps = (	
							{name="s_recorder"; value="recorder";},
							{name="i_inpkt"; value="_FormatUint64(inpkt)";},
							{name="i_outpkt"; value="_FormatUint64(outpkt)";},
							{name="i_send"; value="_FormatUint64(send)";},
							{name="i_rcvd"; value="_FormatUint64(rcvd)";},
							{name="s_top1"; value="top1";},
							{name="s_top2"; value="top2";},
							{name="s_top3"; value="top3";}							
						);
					}
				);
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_msg_id"; value="rule";},	//事件id
					{name="s_application"; value="application";},
					{name="s_interface"; value="interface";},
					{name="s_sdev"; value="sdev";},
					{name="s_ddev"; value="ddev";}
				);
			},
			{
				condition = "e.type == 'conn'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_recorder"; value="recorder";},
					{name="s_proto"; value="proto";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="i_trans_src"; value="FormatIP(trans_src)";},
					{name="i_trans_dst"; value="FormatIP(trans_dst)";},
					{name="i_trans_sport"; value="_FormatUint16(trans_sport)";},
					{name="i_trans_dport"; value="_FormatUint16(trans_dport)";},
					{name="i_inpkt"; value="_FormatUint64(inpkt)";},
					{name="i_outpkt"; value="_FormatUint64(outpkt)";},
					{name="i_send"; value="_FormatUint64(send)";},
					{name="i_rcvd"; value="_FormatUint64(rcvd)";},
					{name="i_duration"; value="_FormatUint64(duration)";},
					{name="s_connid"; value="connid";},
					{name="s_parent"; value="parent";},
					{name="s_op"; value="op";},
					{name="s_message"; value="msg";}
				);
			},
			{
				condition = "e.type == 'ac'";
				maps = (	
					{name="s_sub_type"; value="type";},
					{name="s_recorder"; value="recorder";},
					{name="s_rule"; value="rule";},
					{name="s_proto"; value="proto";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_smac"; value="smac";},
					{name="s_dmac"; value="dmac";},
					{name="s_user"; value="user";},
					{name="s_indev"; value="indev";},
					{name="s_outdev"; value="outdev";},
					{name="s_connid"; value="connid";},
					{name="i_parentid"; value="_FormatUint64(parentid)";},
					{name="s_policyid"; value="policyid";},	
					{name="s_dpiid"; value="dpiid";},
					{name="s_natid"; value="natid";},
					{name="s_message"; value="msg";}
				);
			},
			{
				condition = "e.type == 'pf'";
				maps = (
					{name="s_sub_type"; value="type";},
					{name="s_rule"; value="rule";},
					{name="s_proto"; value="proto";},
					{name="i_src"; value="_FormatIP(src)";},
					{name="i_dst"; value="_FormatIP(dst)";},
					{name="i_sport"; value="_FormatUint16(sport)";},
					{name="i_dport"; value="_FormatUint16(dport)";},
					{name="s_smac"; value="smac";},
					{name="s_dmac"; value="dmac";},
					{name="s_indev"; value="indev";},
					{name="s_policyid"; value="policyid";}
				);
			}
		);
		maps = (
			{name="i_client_addr"; value="_FormatIP(client_addr)";},
			{name="i_time"; value="_FormatTime0(time)";},
			{name="s_fw"; value="fw";},
			{name="s_id"; value="id";},
			{name="s_pri"; value="pri";}
		);
	}
);
